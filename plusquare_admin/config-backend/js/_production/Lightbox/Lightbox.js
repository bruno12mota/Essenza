define(["jquery","ui/ui-elements"],function(a){var k=function(a,c,d,e,f,g,h){void 0==f&&(f="Exit without saving");void 0==g&&(g='Submit <img class="arrow-icon" src="'+c+'images/ui/arrow.png"/>');void 0==e&&(e=900);void 0==h&&(h=!1);this.title=a;this.builderPath=c;this.saveFunction=d;this.exit_text=f;this.submit_text=g;this.width=e;this.loadingLightbox=h;this.build()};k.prototype={build:function(){var b=a("body"),c=this.width;this.lightboxInUse=b.hasClass("adminLightboxOpened");b.addClass("adminLightboxOpened");
this.$cover=a("<div></div>").css({width:"100%",height:"100%","background-color":"#000",position:"fixed",top:"0px",left:"0px",bottom:"0px",right:"0px","z-index":this.lightboxInUse?"101":"99"}).fadeTo(0,0).fadeTo(200,0.7).appendTo(b);var d=a(window).scrollTop();this.$editPage=a("<div></div>").css({position:"absolute",width:c+"px","background-color":"#fff",top:40+d+"px",left:-c/2+"px","margin-left":"50%","margin-bottom":"50px","z-index":this.lightboxInUse?"102":"100",overflow:"hidden"}).fadeTo(0,0).fadeTo(200,
1).appendTo(b);this.$editPage.addRoundCorners("3px");this.$editPage.processFont("AllerRegular","#26202A",15);this.$menu=a("<div>"+this.title+"</div>").css({position:"relative",display:"block","background-color":"#EEEEEE",padding:"20px 25px","border-bottom":"solid 1px #CCCCCC"}).appendTo(this.$editPage);this.loadingLightbox||(this.$exitButton=a('<a href="#"></a>').css({width:"9px",height:"9px","background-image":"url("+this.builderPath+"images/ui/lightbox_close.png)",position:"relative","float":"right",
left:"-10px",top:"6px"}).appendTo(this.$menu).click(a.proxy(this.closeEdit,this)));this.$content=a("<div></div>").css({position:"relative",padding:"20px 25px",display:"block"}).appendTo(this.$editPage);this.loadingLightbox?this.$loadingOptions=a("<div>Saving</div>").css({position:"relative",display:"block","padding-left":"30px","background-image":"url("+this.builderPath+"images/ui/loading.gif)","background-repeat":"no-repeat","background-position":"0 50%"}).appendTo(this.$content):(this.$loadingOptions=
a("<div>Loading Options</div>").css({position:"relative",display:"block","padding-left":"30px","background-image":"url("+this.builderPath+"images/ui/loading.gif)","background-repeat":"no-repeat","background-position":"0 50%"}).appendTo(this.$content),this.$submitMenu=a("<div></div>").css({position:"relative",padding:"20px 25px","border-top":"solid 1px #EEEEEE",overflow:"hidden"}).appendTo(this.$editPage),this.$submitButton=a('<a class="button button-primary button-large disabled" href="#">'+this.submit_text+
"</a>").css({position:"relative","float":"right"}).appendTo(this.$submitMenu).click(a.proxy(this.saveEdit,this)),this.$exitButton=a('<a class="button button-primary button-large disabled" href="#">'+this.exit_text+"</a>").css({position:"relative","float":"right",left:"-10px"}).appendTo(this.$submitMenu).click(a.proxy(this.closeEdit,this)))},addContent:function(a){this.$content.append(a);this.$loadingOptions.remove();this.$submitButton.removeClass("disabled");this.$exitButton.removeClass("disabled")},
switchLoading:function(a){this.$submitButton.addClass("disabled");this.$exitButton.addClass("disabled");this.$content.html(this.$loadingOptions);this.$loadingOptions.css("display","block");this.$loadingOptions.text(a)},closeEdit:function(){var b=a("body");this.$editPage.fadeTo(200,0);this.$cover.fadeTo(200,0,a.proxy(function(){this.$editPage.remove();this.$cover.remove()},this));this.lightboxInUse||b.removeClass("adminLightboxOpened");a(this).trigger("close_lightbox");return!1},saveEdit:function(){this.saveFunction.call();
return!1}};return k});
