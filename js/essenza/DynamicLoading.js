var esza_url=directory.esza_url;
define(["jquery","utils/utils"],function(b){function p(a){var c=0;f?(m.remove(),b(a).insertAfter(n),c="comments"==g?b("#comments_replace_content_wraper").offset().top-80:0):(b("#page-wraper").remove(),b("#page-wraper-full").remove(),b(a).insertAfter(b("#header")));b("body").hasClass("runtime_javascript_ready")&&plusquare_runtime_javascript(!0,f,c);h=f=!1}var k=!1,h=!1,f=!1,m,n,g,e=function(a,c,d,f){this.href=a.attr("href");-1!=this.href.indexOf(esza_url)&&(a.addClass("dynamic_binded"),this.$holder=
c,this.$afterThis=d,this.idAction=f,a.removeClass("dynamic_loading"),void 0==this.idAction&&-1<this.href.indexOf("rel=ajax")?(this.href=this.href.replace("&rel=ajax",""),this.href=this.href.replace("?rel=ajax",""),a.attr("href",this.href)):void 0!=this.idAction&&(this.href=this.href.replace("&rel=ajax",""),this.href=this.href.replace("?rel=ajax",""),this.href=this.href.replace("&rel="+this.idAction,""),this.href=this.href.replace("?rel="+this.idAction,""),a.attr("href",this.href)),a.bind(clickBind,
b.proxy(this.onClick,this)))},l=function(a){k=h=!0;contentLoadingIn();if(-1===a.indexOf("rel=")){var c=f?g:"ajax",d=a+"?rel="+c,d=a.match(RegExp(".*?\\?(.+\\=.+)+","gi")),e=a.match(RegExp("\\#.+","gi"));null!=e&&(a=a.substring(0,a.length-e[0].length));d=null!=d?a+"&rel="+c:a+"?rel="+c;null!=e&&(d+=e[0])}else d=a,a=a.replace("&rel=ajax",""),a=a.replace("?rel=ajax",""),void 0!=g&&(a=a.replace("&rel="+g,""),a=a.replace("?rel="+g,""));b.ajax({url:d,success:p});a!=window.location&&void 0!=window.history.pushState&&
window.history.pushState({path:a},"",a)};e.prototype={onClick:function(a){a.preventDefault();h||(void 0!=this.idAction?(m=this.$holder,n=this.$afterThis,g=this.idAction,f=!0):f=!1,l(this.href));return!1}};b(document).ready(function(){b("#menu a").each(function(){new e(b(this))});b("#menu_mobile a").each(function(){new e(b(this))});b("#searchform").submit(function(){b("#search_info").trigger("close");var a=b(this).attr("action"),c=b(this).find("#search").val(),a=a+"?s="+c;l(a,a+"&rel=ajax");return!1});
b(window).bind("popstate",function(a){k?l(location.pathname):k=!0})});return e});
